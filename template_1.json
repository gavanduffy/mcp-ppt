import Link from 'next/link';
import { listTopFolders, getSlidesBase } from '@/lib/fs';
import path from 'path';

export default function Page() {
  const folders = listTopFolders();
  const base = getSlidesBase();
  const baseLabel = base.endsWith('/slides') ? '/slides' : '(repo root)';

  return (
    <div className="space-y-6">
      <h1 className="text-2xl font-bold">Available Folders</h1>
      <p className="text-sm opacity-70">Scanning: <code>{baseLabel}</code></p>

      {folders.length === 0 && (
        <div className="rounded-lg border bg-white p-6">
          <p>No slideshow folders found.</p>
          <p className="mt-2 text-sm opacity-70">
            Create <code>slides/YourFolder/your-file.html</code> or put folders in repo root (not <code>app/</code>, <code>public/</code>, etc.).
          </p>
        </div>
      )}

      <ul className="grid gap-3 sm:grid-cols-2">
        {folders.map((name) => (
          <li key={name}>
            <Link
              href={`/${encodeURIComponent(name)}`}
              className="block rounded-lg border bg-white p-4 hover:shadow"
            >
              <div className="font-medium">{name}</div>
              <div className="text-xs opacity-60">View HTML files â†’</div>
            </Link>
          </li>
        ))}
      </ul>
    </div>
  );
}